{% extends 'petjoy/base.html' %}
{% load static %}

{% block title %}ค้นหา - PetJoy{% endblock %}

{% block content %}
<main class="content" style="padding:20px; max-width:1100px; margin:0 auto;">
    <section class="search-results">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;">
            <div style="display:flex;align-items:center;gap:12px;">
                <button type="button" onclick="history.back()" class="back-btn" aria-label="ย้อนกลับ">&lt;</button>
                <h2 style="margin:0;">ค้นหา</h2>
            </div>
            <div style="color:#6b7280">ผลการค้นหา: "<strong>{{ query }}</strong>"</div>
        </div>

        <div style="margin-top:16px; display:flex; gap:20px; flex-wrap:wrap; align-items:flex-start;">
            <div style="flex:1 1 65%; min-width:300px;">
                <div style="margin-bottom:8px; color:#374151;">สินค้าที่พบ ({{ products|length }})</div>
                {% if products %}
                    <div style="display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:16px;">
                        {% for product in products %}
                        <article style="border:1px solid #e5e7eb; border-radius:8px; overflow:hidden; background:#fff;">
                            <a href="{% url 'petjoy:product-detail' product.id %}" style="text-decoration:none;color:inherit; display:block;">
                                <div style="height:150px;display:flex;align-items:center;justify-content:center;background:#f9fafb;">
                                    {% if product.image %}
                                        <img src="{{ product.image.url }}" alt="{{ product.name }}" style="max-height:140px; max-width:100%; object-fit:contain;">
                                    {% else %}
                                        <img src="{% static 'images/Cat teaser.jpg' %}" alt="placeholder" style="max-height:140px; object-fit:contain;">
                                    {% endif %}
                                </div>
                                <div style="padding:10px;">
                                    <h3 style="margin:0 0 6px 0; font-size:1rem;">{{ product.name }}</h3>
                                    {% if product.features %}
                                        <p style="margin:0 0 8px 0; color:#6b7280; font-size:0.9rem;">{{ product.features|truncatechars:120 }}</p>
                                    {% elif product.description %}
                                        <p style="margin:0 0 8px 0; color:#6b7280; font-size:0.9rem;">{{ product.description|truncatechars:120 }}</p>
                                    {% endif %}
                                    {% if product.price %}
                                        <div style="font-weight:600; color:#111827;">฿{{ product.price }}</div>
                                    {% endif %}
                                </div>
                            </a>
                        </article>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="no-results" style="padding:16px; background:#fff; border:1px dashed #e5e7eb; border-radius:8px;">ไม่มีสินค้า</div>
                {% endif %}
            </div>

            <aside style="flex:1 1 30%; min-width:220px;">
                <div style="background:#fff; padding:12px; border-radius:8px; border:1px solid #e5e7eb;">
                    <h4 style="margin-top:0;">หมวดหมู่ที่เกี่ยวข้อง</h4>
                    {% if categories %}
                        <ul style="list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:6px;">
                            {% for cat in categories %}
                                <li style="padding:8px; border-radius:6px; background:#f8fafc;">{{ cat.display_name }}</li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <div style="color:#6b7280;">ไม่มีหมวดหมู่ที่เกี่ยวข้อง</div>
                    {% endif %}
                </div>
            </aside>
        </div>
    </section>
</main>
{% endblock %}