{% extends 'petjoy/base.html' %}

{% block content %}
<div class="container" style="max-width:900px; margin:40px auto;">

    <div style="display:flex; align-items:center; gap:12px; margin-bottom:30px;">
        <a href="{% url 'petjoy:homepage' %}"
           style="
               display:inline-flex;
               align-items:center;
               gap:6px;
               padding:10px 16px;
               background:#fff3eb;
               color:#ff7a00;
               border-radius:999px;
               font-size:14px;
               font-weight:600;
               text-decoration:none;
               border:1px solid #ffd2b8;
           ">
            <i class="ri-arrow-left-line"></i>
            กลับหน้าแรก
        </a>

        <h2 style="margin:0; font-size:22px;">การแจ้งเตือน</h2>
    </div>

    {% if orders %}
        {% for order in orders %}
            
            {% if order.status == 'cancelled' %}
            <a href="{% url 'petjoy:order_detail_customer' order.id %}" style="text-decoration:none; color:inherit;">
                <div style="background:#fff;border-radius:20px;padding:20px 22px;margin-bottom:16px;
                            box-shadow:0 6px 18px rgba(0,0,0,0.06);display:flex;justify-content:space-between;align-items:center;">
                    <div>
                        <strong>{{ order.display_title }}</strong><br>
                        <span style="color:#ef4444;font-weight:600;">คำสั่งซื้อถูกยกเลิกแล้ว</span><br>
                        
                        {% if order.cancel_reason %}
                            <small style="color:#666; font-size:13px;">เหตุผล: {{ order.cancel_reason }}</small><br>
                        {% endif %}
                        
                        <small style="color:#aaa;">{{ order.created_at|date:"d M Y • H:i" }}</small>
                    </div>
                </div>
            </a>
            {% endif %}

            {% if order.has_unread_status_update and order.reviews.exists %}
                {% for review in order.reviews.all %}
                    {% if review.reply %}
                    <a href="{% url 'petjoy:order_detail_customer' order.id %}" style="text-decoration:none; color:inherit;">
                        <div style="background:#fff;border-radius:20px;padding:20px 22px;margin-bottom:16px;
                                    box-shadow:0 6px 18px rgba(0,0,0,0.06);display:flex;justify-content:space-between;align-items:center;">
                            <div>
                                <strong>{{ order.display_title }}</strong><br>
                                <span style="color:#ff7a00;font-weight:600;">ร้านค้าตอบกลับรีวิวของคุณแล้ว</span><br>
                                <small style="color:#aaa;">{{ order.created_at|date:"d M Y • H:i" }}</small>
                            </div>
                        </div>
                    </a>
                    {% endif %}
                {% endfor %}
            {% endif %}

            {% if order.status == 'success' %}
            <div style="background:#fff;border-radius:20px;padding:20px 22px;margin-bottom:16px;
                        box-shadow:0 6px 18px rgba(0,0,0,0.06);display:flex;justify-content:space-between;align-items:center;">
                <div>
                    <strong>{{ order.display_title }}</strong><br>
                    <span style="color:#22c55e;font-weight:600;">จัดส่งสำเร็จ</span><br>
                    <small style="color:#aaa;">{{ order.created_at|date:"d M Y • H:i" }}</small>
                </div>

                {% if not order.reviews.exists %}
                <a href="{% url 'petjoy:review_product' order.id %}"
                   style="padding:8px 16px;background:#ff7a00;color:#fff;
                          border-radius:999px;font-size:14px;text-decoration:none;">
                    รีวิวสินค้า
                </a>
                {% else %}
                <span style="color:#22c55e; font-size:14px;">
                    <i class="ri-checkbox-circle-fill"></i> รีวิวแล้ว
                </span>
                {% endif %}
            </div>
            {% endif %}

        {% endfor %}
    {% else %}
        <div style="text-align:center; padding:60px 20px; background:#fff; border-radius:20px; box-shadow:0 4px 15px rgba(0,0,0,0.05);">
            <i class="ri-notification-off-line" style="font-size:48px; color:#ccc; margin-bottom:15px; display:block;"></i>
            <h3 style="color:#666; margin:0 0 10px 0;">ไม่มีการแจ้งเตือนใหม่</h3>
            <p style="color:#999; margin:0;">เมื่อมีการอัปเดตคำสั่งซื้อของคุณ จะแสดงที่นี่</p>
        </div>
    {% endif %}

</div>
{% endblock %}