{% extends "petjoy/base.html" %}
{% load static %}

{% block title %}โปรไฟล์ของฉัน{% endblock %}

{% block content %}
<div class="profile-page-wrapper">
    <aside class="profile-sidebar">
        <h3 class="profile-sidebar-title">ข้อมูลส่วนตัว</h3>
        <nav class="profile-menu">
            <a href="#" class="profile-menu-item active">ข้อมูลส่วนตัว</a>
            <a href="#" class="profile-menu-item">ที่อยู่</a>
            <a href="#" class="profile-menu-item">ประวัติการสั่งซื้อ</a>
            <a href="{% url 'petjoy:favorites_list' %}" class="profile-menu-item">รายการโปรด</a>
            <form method="post" action="{% url 'petjoy:logout' %}" class="logout-form">
                {% csrf_token %}
                <button type="submit" class="profile-menu-item logout-button">ออกจากระบบ</button>
            </form>
        </nav>
    </aside>
    <div class="profile-card">
        <div class="profile-image-section">
            {% if user.profile.image %}
            <img src="{{ user.profile.image.url }}" alt="{{ user.username }}" class="profile-image-large">
            {% else %}
            <img src="{% static 'images/อินแล้ว.jpg' %}" alt="{{ user.username }}" class="profile-image-large">
            {% endif %}
        </div>
        <div class="profile-info-section">
            {% if editing %}
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="form-row">
                    {{ user_form.first_name.label_tag }}
                    {{ user_form.first_name }}
                </div>
                <div class="form-row">
                    {{ user_form.last_name.label_tag }}
                    {{ user_form.last_name }}
                </div>
                <div class="form-row">
                    {{ user_form.email.label_tag }}
                    {{ user_form.email }}
                </div>
                <div class="form-row">
                    <label for="id_image">รูปโปรไฟล์</label>
                    {{ profile_form.image }}
                </div>
                <div class="form-row">
                    {{ user_form.password.label_tag }}
                    {{ user_form.password }}
                    <small>เว้นว่างไว้หากไม่ต้องการเปลี่ยนรหัสผ่าน</small>
                </div>
                <div style="margin-top:16px;">
                    <button type="submit" class="profile-edit-btn">บันทึกการเปลี่ยนแปลง</button>
                    <a href="{% url 'petjoy:profile' %}" class="white-btn" style="margin-left:8px;">ยกเลิก</a>
                </div>
            </form>
            {% else %}
            <h2 class="profile-name">{{ user.get_full_name|default:user.username }}</h2>
            <div class="profile-email">{{ user.email }}</div>
            <div class="profile-detail-row">
                <b>ชื่อ-นามสกุล</b>
                <span class="profile-detail-value">{{ user.get_full_name|default:user.username }}</span>
            </div>
            <div class="profile-detail-row">
                <b>อีเมล์</b>
                <span class="profile-detail-value">{{ user.email }}</span>
            </div>
            <div class="profile-detail-row">
                <b>รหัสผ่าน</b>
                <span class="profile-detail-value">******</span>
            </div>
            <a href="?edit=1" class="profile-edit-btn">แก้ไข</a>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}