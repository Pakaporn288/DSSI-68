{% extends "petjoy/base.html" %}
{% load static %}
{% block title %}ที่อยู่จัดส่ง{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'profile_new.css' %}">

<div class="profile-container">

    <!-- SIDEBAR -->
    <aside class="profile-sidebar-card">
        <div class="sidebar-user-box">
            {% if user.profile.image %}
                <img src="{{ user.profile.image.url }}" class="sidebar-profile-image">
            {% else %}
                <img src="{% static 'images/อินแล้ว.jpg' %}" class="sidebar-profile-image">
            {% endif %}
            <h3>{{ user.get_full_name|default:user.username }}</h3>
            <p class="sidebar-email">{{ user.email }}</p>
        </div>

        <nav class="sidebar-menu">
            <a href="{% url 'petjoy:profile' %}" class="menu-item">ข้อมูลส่วนตัว</a>
            <a href="{% url 'petjoy:address_list' %}" class="menu-item active">ที่อยู่</a>
            <a href="{% url 'petjoy:chat_list' %}" class="menu-item">ข้อความ</a>
            <a href="{% url 'petjoy:order_history' %}" class="menu-item">ประวัติการสั่งซื้อ</a>
            <a href="{% url 'petjoy:favorites_list' %}" class="menu-item">รายการโปรด</a>

            <form action="{% url 'petjoy:logout' %}" method="post">
                {% csrf_token %}
                <button class="logout-btn">ออกจากระบบ</button>
            </form>
        </nav>
    </aside>

    <!-- MAIN CONTENT -->
    <section class="profile-main-card">
        <h2 class="section-title">ที่อยู่สำหรับการจัดส่ง</h2>

        <!-- ADDRESS LIST -->
        <div class="address-list">

            {% for address in addresses %}
            <div class="address-card">

                <div class="address-header">
                    <h3>{{ address.full_name }}</h3>
                    {% if address.is_default %}
                        <span class="default-badge">ค่าเริ่มต้น</span>
                    {% endif %}
                </div>

                <p>{{ address.phone }}</p>
                <p>{{ address.address_line }}</p>
                <p>{{ address.subdistrict }}, {{ address.district }}, {{ address.province }} {{ address.zipcode }}</p>

                <div class="address-actions">
                    <a href="{% url 'petjoy:address_edit' address.id %}" class="btn-orange">แก้ไข</a>
                    <a href="{% url 'petjoy:address_delete' address.id %}" class="btn-red">ลบ</a>

                    {% if not address.is_default %}
                    <a href="{% url 'petjoy:address_set_default' address.id %}" class="btn-outline">
                        ตั้งเป็นค่าเริ่มต้น
                    </a>
                    {% endif %}
                </div>

            </div>
            {% empty %}
                <p>ยังไม่มีที่อยู่ กรุณาเพิ่มที่อยู่ใหม่</p>
            {% endfor %}
        </div>

        <a href="{% url 'petjoy:address_add' %}" class="add-address-btn">
            + เพิ่มที่อยู่ใหม่
        </a>

    </section>
</div>

{% endblock %}
