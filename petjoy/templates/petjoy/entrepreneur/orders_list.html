{% load static %}

<link rel="stylesheet" href="{% static 'entrepreneur.css' %}">
<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
    .stat-box {
        background: white;
        border-radius: 14px;
        padding: 20px;
        box-shadow: 0 4px 14px rgba(0,0,0,0.08);
        text-align: center;
        flex: 1;
        min-width: 160px;
    }
    .stat-title {
        color: #E65100;
        font-weight: 700;
        font-size: 16px;
        margin-bottom: 10px;
    }
    .stat-number {
        font-size: 26px;
        font-weight: 800;
        color: #FF6A2E;
    }

    .orders-section-title {
        font-size: 20px;
        font-weight: 700;
        margin: 25px 0 15px 0;
        color: #E65100;
    }

    .recent-orders-box {
        background: white;
        border-radius: 14px;
        padding: 20px;
        box-shadow: 0 4px 14px rgba(0,0,0,0.08);
        margin-bottom: 25px;
    }

    .recent-item {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        border-bottom: 1px solid #f2f2f2;
    }

    .recent-item:last-child {
        border-bottom: none;
    }

    .orders-table {
        width: 100%;
        background: white;
        border-radius: 14px;
        padding: 20px;
        box-shadow: 0 4px 16px rgba(0,0,0,0.08);
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
    }

    th {
        background: #FFEDE2;
        color: #E65100;
        padding: 12px;
        font-weight: 700;
        text-align: center;
    }

    td {
        padding: 12px;
        border-bottom: 1px solid #f2f2f2;
        text-align: center;
        font-weight: 500;
    }

    .status-badge {
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 14px;
        font-weight: 600;
        display: inline-block;
    }

    .status-wait { background: #FFF3CD; color: #856404; }
    .status-paid { background: #D4EDDA; color: #155724; }
    .status-preparing { background: #D1ECF1; color: #0C5460; }
    .status-delivering { background: #CCE5FF; color: #004085; }
    .status-success { background: #C3E6CB; color: #155724; }

    .btn-view {
        padding: 6px 14px;
        background: #FF8A50;
        color: white;
        border-radius: 8px;
        text-decoration: none;
        font-size: 14px;
        font-weight: 600;
    }

    /* New order-code badge style */
    .order-code {
        background: #FFE0CC;
        color: #D65200;
        padding: 6px 12px;
        border-radius: 8px;
        font-weight: 700;
        font-size: 14px;
        display: inline-block;
    }
</style>

<div class="seller-layout">

    <!-- SIDEBAR -->
    <aside class="seller-sidebar">

        <div class="seller-profile">
            {% if entrepreneur.profile_image %}
                <img src="{{ entrepreneur.profile_image.url }}" class="seller-avatar">
            {% else %}
                <img src="{% static 'images/‡∏£‡πâ‡∏≤‡∏ô.png' %}" class="seller-avatar">
            {% endif %}
            <h3 class="seller-name">{{ entrepreneur.store_name }}</h3>
            <p class="seller-username">@{{ entrepreneur.user.username }}</p>
        </div>

        <nav class="seller-menu">
            <a href="{% url 'petjoy:entrepreneur-home' %}">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏£‡πâ‡∏≤‡∏ô</a>
            <a class="active" href="{% url 'petjoy:orders-list' %}">üì¶ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</a>
            <a href="{% url 'petjoy:product-list' %}">üõçÔ∏è ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a>
            <a href="{% url 'petjoy:entrepreneur-chat-list' %}">üí¨ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</a>
            <a href="{% url 'petjoy:entrepreneur_profile_settings' %}">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏£‡πâ‡∏≤‡∏ô</a>
            <a href="{% url 'petjoy:entrepreneur_reviews' %}">üìã ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a>
            <a href="#">üí∞ ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</a>
        </nav>

        <form method="post" action="{% url 'petjoy:logout' %}">
            {% csrf_token %}
            <button class="seller-logout">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
        </form>

    </aside>

    <!-- MAIN -->
    <main class="seller-main">

        <!-- MESSAGES -->
        {% if messages %}
        <div class="dashboard-messages">
            {% for message in messages %}
                <div class="dashboard-message-item">{{ message }}</div>
            {% endfor %}
        </div>
        {% endif %}

        <h2 class="section-title">üì¶ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h2>

        <!-- ‚ñ∂ ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ -->
        <div style="display: flex; gap: 20px; margin-bottom: 25px; flex-wrap: wrap;">

            <div class="stat-box">
                <div class="stat-title">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
                <div class="stat-number">{{ orders.count }}</div>
            </div>

            <div class="stat-box">
                <div class="stat-title">‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</div>
                <div class="stat-number">{{ shipping_count }}</div>
            </div>

            <div class="stat-box">
                <div class="stat-title">‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</div>
                <div class="stat-number">{{ success_count }}</div>
            </div>

            <div class="stat-box">
                <div class="stat-title">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß</div>
                <div class="stat-number">{{ canceled_count }}</div>
            </div>

        </div>

        <!-- ‚ñ∂ ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå 5 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î -->
        <h3 class="orders-section-title">üÜï ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ 5 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>

        <div class="recent-orders-box">
            {% if recent_orders %}
                {% for o in recent_orders %}
                <div class="recent-item">
                    <span>‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ <strong style="color:#FF6A2E;">ORD-{{ o.order_number|stringformat:"06d" }}</strong> - {{ o.customer_name }}</span>
                    <a href="{% url 'petjoy:orders-detail' o.id %}" class="btn-view">‡∏î‡∏π</a>
                </div>
                {% endfor %}
            {% else %}
                <p style="text-align:center; color:#888;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤</p>
            {% endif %}
        </div>

        <!-- ‚ñ∂ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î -->
        <div class="orders-table">

            <table>
                <thead>
                    <tr>
                        <th>‡∏£‡∏´‡∏±‡∏™</th>
                        <th>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
                        <th>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</th>
                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</th>
                        <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                    </tr>
                </thead>

                <tbody>
                    {% for order in orders %}
                    <tr>

                        <!-- NEW formatted order code -->
                        <td>
                            <span class="order-code">ORD-{{ order.order_number|stringformat:"06d" }}</span>
                        </td>

                        <td>{{ order.customer_name }}</td>
                        <td>{{ order.total_price }} ‡∏ö‡∏≤‡∏ó</td>

                        <td>
                            {% if order.status == "waiting" %}
                                <span class="status-badge status-wait">‡∏£‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</span>
                            {% elif order.status == "paid" %}
                                <span class="status-badge status-paid">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß</span>
                            {% elif order.status == "preparing" %}
                                <span class="status-badge status-preparing">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡∏≠‡∏á</span>
                            {% elif order.status == "delivering" %}
                                <span class="status-badge status-delivering">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</span>
                            {% elif order.status == "success" %}
                                <span class="status-badge status-success">‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</span>
                            {% endif %}
                        </td>

                        <td>{{ order.created_at|date:"d/m/Y" }}</td>

                        <td>
                            <a href="{% url 'petjoy:orders-detail' order.id %}" class="btn-view">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</a>
                        </td>

                    </tr>
                    {% endfor %}
                </tbody>
            </table>

        </div>

    </main>

</div>
