{% extends "petjoy/admin/admin_base.html" %}
{% load static %}
{% block content %}
<style>
    .card {
        background: #fff;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        margin-bottom: 25px;
    }

    .form-group {
        margin-bottom: 15px;
    }

    label {
        font-weight: 600;
        display: block;
        margin-bottom: 6px;
    }

    input, select {
        width: 100%;
        padding: 8px 10px;
        border-radius: 8px;
        border: 1px solid #ddd;
    }

    button {
        padding: 8px 14px;
        border-radius: 8px;
        border: none;
        cursor: pointer;
    }

    .btn-primary {
        background: #4e73df;
        color: #fff;
    }

    .btn-danger {
        background: #e74a3b;
        color: #fff;
    }

    table {
        width: 100%;
        border-collapse: collapse;
    }

    th, td {
        padding: 10px;
        border-bottom: 1px solid #eee;
        vertical-align: middle;
    }

    .img-preview {
        width: 60px;
        height: 60px;
        object-fit: cover;
        border-radius: 8px;
        border: 1px solid #ddd;
    }
</style>

<h2>‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô - ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>

<!-- =======================
     ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
======================= -->
<div class="card">
    <h4>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h4>

    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <input type="hidden" name="action" value="add">

        <div class="form-group">
            <label>Key ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
            <input type="text" name="name" placeholder="‡πÄ‡∏ä‡πà‡∏ô dog, cat, food" required>
        </div>

        <div class="form-group">
            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á</label>
            <input type="text" name="display_name" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏∏‡∏ô‡∏±‡∏Ç, ‡πÅ‡∏°‡∏ß, ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏±‡∏ï‡∏ß‡πå" required>
        </div>

        <div class="form-group" id="food-type-box" style="display:none;">
            <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏≠‡∏≤‡∏´‡∏≤‡∏£</label>
            <select name="food_type">
                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó --</option>
                <option value="dog">‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏∏‡∏ô‡∏±‡∏Ç</option>
                <option value="cat">‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏°‡∏ß</option>
            </select>
        </div>

        <div class="form-group">
            <label>‡∏£‡∏π‡∏õ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
            <input type="file" name="image" accept="image/*">
        </div>

        <button type="submit" class="btn-primary">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</button>
    </form>
</div>

<!-- =======================
     ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
======================= -->
<div class="card">
    <h4>üìã ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h4>

    <table>
        <tr>
            <th>ID</th>
            <th>Key</th>
            <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á</th>
            <th>‡∏£‡∏π‡∏õ</th>
            <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
        </tr>

        {% for cat in categories %}
        <tr>
            <td>{{ cat.id }}</td>
            <td>{{ cat.name }}</td>

            <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç -->
            <td colspan="3">
                <form method="post" enctype="multipart/form-data" style="display:flex; gap:10px; align-items:center;">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="edit">
                    <input type="hidden" name="id" value="{{ cat.id }}">

                    <input type="text" name="display_name" value="{{ cat.display_name }}" style="width:200px;">

                    {% if cat.image %}
                        <img src="{{ cat.image.url }}" class="img-preview">
                    {% else %}
                        <img src="{% static 'images/default.png' %}" class="img-preview">
                    {% endif %}

                    <input type="file" name="image" accept="image/*">

                    <button class="btn-primary">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                </form>
            </td>

            <!-- ‡∏•‡∏ö -->
            <td>
                <form method="post">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="delete">
                    <input type="hidden" name="id" value="{{ cat.id }}">
                    <button class="btn-danger" onclick="return confirm('‡∏•‡∏ö‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ô‡∏µ‡πâ?')">
                        ‡∏•‡∏ö
                    </button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>
</div>

<script>
    const nameInput = document.querySelector('input[name="name"]');
    const foodBox = document.getElementById('food-type-box');

    if (nameInput) {
        nameInput.addEventListener('input', function () {
            if (this.value.toLowerCase().includes('food')) {
                foodBox.style.display = 'block';
            } else {
                foodBox.style.display = 'none';
            }
        });
    }
</script>

{% endblock %}
